
<HTML>
<HEAD><TITLE>Linux Setup Guide</TITLE></HEAD>

<BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#110860" VLINK="#A20F14">

<font color=#110860><center><h1>Linux Setup</h1></center></font>
<HR WIDTH=55% ALIGN=CENTER>
<p>
<b>The following instructions are made available thanks to 
<a href="http://www.horvath.com" target="_top">Bob Horvath</a> and the wonderful web pages he
wrote
describing <a href="http://www.horvath.com/linux/ppp" target="_top">how to connect Linux with
EnterAct</a> 
using Red Hat 4.0. A gigantic thanks goes out to him for his help.</b><p>

Before you can configure Linux to work with EnterAct, you must 
<a href="http://sunsite.unc.edu/mdw/HOWTO/Kernel-HOWTO.html" target="_top">compile Networking
and PPP</a>
into the kernel.  For the purposes of this document, we will assume that you have
already done this.
<p>
Before configuring Linux with these instructions, keep in mind that your distribution 
may do things differently. If you have PPP 2.2 or later, there will be no need to
make any alterations to the following instructions.
<p>
If you are using PPP 2.1.2 or earlier, depending on the distribution you are
running, you may not see the actual files that are mentioned in this
setup guide.  The scripts in this document will work regardless of the
version you are using though.
<p>
For more information, please go 
<a href="http://sunsite.unc.edu/mdw/HOWTO/PPP-HOWTO-15.html#automate" target="_top">here</a>.

<p>
Should you have questions that this document does not answer, check out 
<a href="http://sunsite.unc.edu/mdw/HOWTO/" target="_top">The Linux PPP HOWTO</a>
documentation.

<p>

<h3>Network Configuration</h3>

<b>/etc/HOSTNAME</b>
<br>
The first of these is /etc/HOSTNAME or /etc/hostname depending on your distribution of Linux.  This file is what
holds the host name and domain name of your machine.  An example entry in this file
would be:<p>
<font color=#bb0000>machinename.enteract.com</font>
<p>
where "machinename" could be changed to anything you like.
<p>
<b>/etc/hosts</b>
<br>
This file sets up the name and IP address of your local hosts.  It should look like
this:<p>
<font color=#bb0000>
<pre>
127.0.0.1 localhost loopback
10.10.10.10 machinename.enteract.com machinename
</pre>
</font>
<p>
This will allow your machine to know your IP address and local host address
without needing DNS to resolve them for you.  The loopback address should
be as shown above and the machinename address can change if you have your
own static IP address.  If you use a dynamically assigned IP address, and
you are on a standalone machine, 10.10.10.10 is the correct address to use since 
it is reserved by the Internic for just such a purpose.
<p>
<b>/etc/resolv.conf</b>
<br>
This file sets up DNS for your machine.  To configure it for EnterAct, it should
look like this:<p>
<font color=#bb0000>
<pre>
search          enteract.com 
nameserver      207.229.143.1
nameserver      207.229.143.2
</pre>
</font>
<p>
<h3>Configuring PPP</h3>
In order to configure PPP, you will have to edit a couple of scripts.  
<p>
<b>/etc/ppp/ppp-on-dialer</b>
<br>
This file dials your connection and tells you if your connection is established or not.
The following script is taken directly from the defaul script offered from Red Hat 4.0.
<p>
<font color=#bb0000>
<pre>

#!/bin/sh
#
# This is part 2 of the ppp-on script. It will perform the connection
# protocol for the desired connection.
#
exec /usr/sbin/chat -v                                  \
        TIMEOUT         3                               \
        ABORT           '\nBUSY\r'                      \
        ABORT           '\nNO ANSWER\r'                 \
        ABORT           '\nRINGING\r\n\r\nRINGING\r'    \
        ''              \rAT                            \
        'OK-+++\c-OK'   ATH0                            \
        TIMEOUT         30                              \
        OK              ATDT$TELEPHONE                  \
        CONNECT         ''                              \
        ogin:--ogin:    $ACCOUNT                        \
        assword:        $PASSWORD
</pre>
</font>
<p>
<b>/usr/local/bin/enteract (ppp-on)</b>
<br>
This file holds your username, password, and phone number which you will dial
to connect to EnterAct.  It calls the ppp-on-dialer script and supplies that
script with the information it needs to establish a connection.  You do not
have to put this file in /usr/local/bin and you do not have to call it
enteract.  

This particular script was created from a script called ppp-on that was located in the
/usr/doc/ppp-2.2.0f-2/scripts directory. 
<p>
<font color=#bb0000>
<pre>
#!/bin/sh
#
# Script to initiate a ppp connection. This is the first part of the
# pair of scripts. This is not a secure pair of scripts as the codes
# are visible with the 'ps' command.  However, it is simple.
#
# These are the parameters. Change as needed.
TELEPHONE=??            # The telephone number for the connection
ACCOUNT=??              # The account name for logon (as in 'George Burns')
PASSWORD=??             # The password for this account (and 'Gracie Allen')
LOCAL_IP=0.0.0.0        # Local IP address if known. Dynamic = 0.0.0.0
REMOTE_IP=0.0.0.0       # Remote IP address if desired. Normally 0.0.0.0
NETMASK=255.255.255.0   # The proper netmask if needed
#
# Export them so that they will be available at 'ppp-on-dialer' time.
export TELEPHONE ACCOUNT PASSWORD
# 
# This is the location of the script which dials the phone and logs
# in.  Please use the absolute file name as the $PATH variable is not
# used on the connect option.  (To do so on a 'root' account would be
# a security hole so don't ask.)
#
DIALER_SCRIPT=/etc/ppp/ppp-on-dialer
#
# Initiate the connection
# 
# Most of the common options are in this command. Please, don't
# forget the 'lock' option or some programs such as mgetty will not
# work. Asyncmap and escape will permit the PPP link to work with
# a telnet or rlogin connection. You are welcome to make any changes
# as desired. Don't use the 'defaultroute' option if you currently
# have a default route to an ethernet gateway.
#
exec /usr/sbin/pppd debug lock modem crtscts /dev/modem 38400 \
        asyncmap 20A0000 escape FF kdebug 0 $LOCAL_IP:$REMOTE_IP \
        noipdefault netmask $NETMASK defaultroute connect $DIALER_SCRIPT \
	ipparam enteract

</pre>
</font>
<p>

You should of course enter a valid <a href="http://www.enteract.com/where.html">phone
number</a> as well as your username and password instead of the question marks (remember that
your username must be lowercase and your password is case sensitive). 
<p>
If you have a dynamic IP address (EnterAct assigns you an address dynamically by
default unless you request a static one) enter 0.0.0.0 where asked for a local_IP.
If you have a static IP address, enter it in that field instead.  Even if you do
enter 0.0.0.0 in the local_IP field, however, and you do have a static IP address,
we will still assign you your static IP address when you connect. The Remote IP and 
Netmask should be the values shown above.
<p> 
In the last section, "ipparam enteract" is not strictly necessary but is helpful if you
connect to more than one ISP, or when using PPP. This is a parameter that gets passed to a
script called <i>ip-up</i> allowing commands to be executed as root to finish setting up the
connection. 
<p>
<b>IP-Up</b><br>
The following ip-up script makes a soft link to a connection specific resolv.conf file. This
makes name resolution automatic when connecting to more than one place. You can of course do
other things in this script. If you connect to more than once place, then just add more cases
for each connection you have. Here is an example script:

<p>
<font color=#bb0000>
<pre>
#! /bin/tcsh 
echo $6
switch ($6)
        case enteract:
                ln -sf /etc/ppp/enteract/resolv.conf /etc/resolv.conf
                breaksw
        default:
                ln -sf /etc/ppp/default/resolv.conf /etc/resolv.conf
                breaksw
endsw
</pre>
</font>

<p>
<b>IP-Down</b><br>
There is an accompanying ip-down script.  It should look like this:
<p>
<font color=#bb0000>
<pre>
#! /bin/sh
ln -sf /etc/ppp/default/resolv.conf /etc/resolv.conf
</pre>
</font>

<h3>Letting Users Other Than Root Start PPPD</h3>
It's not always a good idea to run everyday tasks as root.  However, pppd is a 
kernel function and requires root to run it.  There is a way to get around this
though.  Using setuid lets you run pppd with the permissions of root.  Although
setuid can frequently create security problems, pppd is written so that setuid
is secure.
<p>
To run pppd using setuid, use the following command:<p>
<font color=#bb0000>chmod u+s /usr/sbin/pppd</font>
<p>
You also must give /usr/local/bin/enteract execute permissions to everyone.  Type
the following command to accomplish this:<p> 
<font color=#bb0000>chmod u+x /usr/local/bin/enteract</font>

<h3>Making a Connection</h3>
To activate a PPP connection, execute 'enteract'. You can monitor the progress using the
command <font color=#bb0000>tail -f /var/log/messages</font>.

<h3>Closing a Connection</h3>
To deactivate a PPP connection, execute 'ppp-off'. This script can be found in
/usr/doc/ppp-2.2.0f-2/scripts but you can move it anywhere you like.

 
</body>
</html>
