<HTML><HEAD><TITLE>TCP vs UDP - HackersQuest Discussion Board</title><META HTTP-EQUIV="Pragma" CONTENT="no-cache">

</head>
<BODY bgcolor="#000000"   text="#ffffff" link="#00ff00" alink="#00ff00" vlink="#00ff00" marginheight=0 marginwidth=0 topmargin=0 leftmargin=0 rightmargin=0>

<FONT SIZE="2" FACE="Verdana, Arial"><center>
<table border=0 width=95%><TR>
<td valign=top align=left><A HREF="http://www.ethernalquest.com/cgi-bin/Ultimate.cgi?action=intro&BypassCookie=true"><IMG SRC="http://www.ethernalquest.com/ubb/../images/hq-title-shock.gif" BORDER=0></A>

</td>
<td valign=top NOWRAP>
<FONT SIZE="1" FACE="Verdana, Arial">
<IMG SRC="http://www.ethernalquest.com/ubb/open.gif"  BORDER=0>&nbsp;&nbsp;<A HREF="http://www.ethernalquest.com/cgi-bin/Ultimate.cgi?action=intro&BypassCookie=true">HackersQuest Discussion Board</A>
<br><IMG SRC="http://www.ethernalquest.com/ubb/tline.gif" BORDER=0><IMG SRC="http://www.ethernalquest.com/ubb/open.gif"  BORDER=0>&nbsp;&nbsp;<A HREF="http://www.ethernalquest.com/cgi-bin/forumdisplay.cgi?action=topics&forum=ShowEQ+Linux+Development&number=4">ShowEQ Linux Development</A>
<br>
<IMG SRC="http://www.ethernalquest.com/ubb/tline3.gif" BORDER=0><IMG SRC="http://www.ethernalquest.com/ubb/open.gif" BORDER=0>&nbsp;&nbsp;TCP vs UDP 
<center>
<P><FONT SIZE="2" FACE="Verdana, Arial">
<A HREF="http://www.ethernalquest.com/cgi-bin/postings.cgi?action=newtopic&number=4&forum=ShowEQ+Linux+Development"><IMG SRC="http://www.ethernalquest.com/ubb/hq-post.jpg"  BORDER=0 ALT="Post New Topic"></A>&nbsp;&nbsp;<A HREF="http://www.ethernalquest.com/cgi-bin/postings.cgi?action=reply&forum=ShowEQ+Linux+Development&number=4&topic=000664.cgi&TopicSubject=TCP+vs+UDP"><IMG SRC="http://www.ethernalquest.com/ubb/hq-reply.jpg" BORDER=0 ALT="Post A Reply"></A></FONT>
<BR>
<A HREF="http://www.ethernalquest.com/cgi-bin/ubbmisc.cgi?action=editbio&Browser=&DaysPrune=&LastLogin="><ACRONYM TITLE="Click here to edit your profile.">profile</ACRONYM></A> | <A HREF="http://www.ethernalquest.com/cgi-bin/Ultimate.cgi?action=agree"><ACRONYM TITLE="Registration is free!">register</ACRONYM></A> | <A HREF="http://www.ethernalquest.com/cgi-bin/ubbmisc.cgi?action=setprefs"><ACRONYM TITLE="Set your preferences.">preferences</ACRONYM></A> | <A HREF="http://www.ethernalquest.com/ubb/faq.html" target=_blank><ACRONYM TITLE="Frequently Asked Questions">faq</ACRONYM></A> | <A HREF="http://www.ethernalquest.com/cgi-bin/search.cgi?action=intro&default=4"><ACRONYM TITLE="Perform a search by keyword, date, or name.">search</ACRONYM></A>
</font>
</center>
</td></tr>
</table>
<table border=0 width=95%>
<tr><TD valign=bottom align=left><FONT SIZE="1" FACE="Verdana, Arial"><IMG SRC="http://www.ethernalquest.com/ubb/ubbfriendminiicon.gif" BORDER=0> <A HREF="http://www.ethernalquest.com/cgi-bin/ubbmisc.cgi?action=sendthread&thread=http://www.ethernalquest.com/ubb/Forum4/HTML/000664.html&Subject=TCP+vs+UDP">UBBFriend: Email This Page to Someone!</A>   </font></TD>
<TD align=right  valign=bottom><FONT SIZE="1" FACE="Verdana, Arial">
<A HREF="http://www.ethernalquest.com/cgi-bin/ubbmisc.cgi?action=findthread&forum=Forum4&number=4&thisthread=000664&go=newer"><ACRONYM TITLE="Go to the next newest topic in this forum.">next newest topic</ACRONYM></A> | <A HREF="http://www.ethernalquest.com/cgi-bin/ubbmisc.cgi?action=findthread&forum=Forum4&number=4&thisthread=000664&go=older"><ACRONYM TITLE="Go to the next oldest topic in this forum.">next oldest topic</ACRONYM></A></font>
</TD></tr></table>


<table width=95% border=0 cellspacing=1 cellpadding=4>
<TR bgcolor="#000000">
<TD valign=middle width=18%>
<FONT SIZE="1" face="Verdana, Arial" color="#00ff00"><B>Author</B></FONT>
</TD>
<TD valign=middle>
<FONT SIZE="1" face="Verdana, Arial" color="#00ff00"><B>Topic:&nbsp;&nbsp; TCP vs UDP</B></FONT>
</TD>
</TR><tr bgcolor="#1f1f1f">
	<TD width=18% valign=top>
	<FONT SIZE="2" face="Verdana, Arial"><B>Mr Guy</B></font><BR><FONT SIZE="1" face="Verdana, Arial">Zombie </FONT>
</td>
<TD>
<IMG SRC="http://www.ethernalquest.com/ubb/icons/icon1.gif" BORDER=0 ALIGN=ABSCENTER>
<FONT SIZE="2" FACE="Verdana, Arial">
<FONT SIZE="1" color="#32cd32" face="Verdana, Arial">posted 11-16-2001 01:40 AM &nbsp;&nbsp;&nbsp;
<A HREF="http://www.ethernalquest.com/cgi-bin/ubbmisc.cgi?action=getbio&UserName=Mr+Guy" target=_blank>
<IMG SRC="http://www.ethernalquest.com/ubb/profile.gif" BORDER=0 ALT="Click Here to See the Profile for Mr Guy"></A> &nbsp;&nbsp;<A HREF="http://www.ethernalquest.com/cgi-bin/Ultimate.cgi?action=email&ToWhom=Mr+Guy" target=_blank><IMG SRC="http://www.ethernalquest.com/ubb/email.gif" BORDER=0 ALT="Click Here to Email Mr Guy"></A>&nbsp;&nbsp; &nbsp;&nbsp;<A HREF="http://www.ethernalquest.com/cgi-bin/postings.cgi?action=editpost&forum=ShowEQ+Linux+Development&number=4&topic=000664.cgi&ReplyNum=000000&TopicSubject=TCP+vs+UDP"><IMG SRC="http://www.ethernalquest.com/ubb/edit.gif"  BORDER=0 ALT="Edit/Delete Message"></A> 
</FONT><HR>At which point does EQ switch to UDP packets?<P>I just realized that I can't particularly test whether what I wrote works, as I sure don't know how to decode the packets, and the pcap_dump is all giberish, so I don't know whether it's working or not!</FONT><P align=right><FONT SIZE="1" color="#32cd32" face="Verdana, Arial">IP: <A HREF="http://www.ethernalquest.com/cgi-bin/ubbmisc.cgi?action=getip&number=4&topic=000664.cgi&ReplyNum=000000&forum=ShowEQ+Linux+Development&TopicSubject=TCP+vs+UDP">Logged</A></font></P></td></tr><tr bgcolor="#1f1f1f">
	<TD width=18% valign=top>
	<FONT SIZE="2" face="Verdana, Arial"><B>FrozenInTime</B></font><BR><FONT SIZE="1" face="Verdana, Arial">Zombie </FONT>
</td>
<TD>
<IMG SRC="http://www.ethernalquest.com/ubb/icons/icon1.gif" BORDER=0 ALIGN=ABSCENTER>
<FONT SIZE="2" FACE="Verdana, Arial">
<FONT SIZE="1" color="#32cd32" face="Verdana, Arial">posted 11-16-2001 04:10 AM &nbsp;&nbsp;&nbsp;
<A HREF="http://www.ethernalquest.com/cgi-bin/ubbmisc.cgi?action=getbio&UserName=FrozenInTime" target=_blank>
<IMG SRC="http://www.ethernalquest.com/ubb/profile.gif" BORDER=0 ALT="Click Here to See the Profile for FrozenInTime"></A> &nbsp; &nbsp;&nbsp;<A HREF="http://www.ethernalquest.com/cgi-bin/postings.cgi?action=editpost&forum=ShowEQ+Linux+Development&number=4&topic=000664.cgi&ReplyNum=000001&TopicSubject=TCP+vs+UDP"><IMG SRC="http://www.ethernalquest.com/ubb/edit.gif"  BORDER=0 ALT="Edit/Delete Message"></A> 
</FONT><HR>TCP is used for logging in and going to the chat channels.<P>UDP is for when you join the world and start playing a character.<P>The reason, once you start playing the order of packet arrival stops mattering to the client.  It's more interested in what is happening now than what that monster did a few seconds ago.</FONT><P align=right><FONT SIZE="1" color="#32cd32" face="Verdana, Arial">IP: <A HREF="http://www.ethernalquest.com/cgi-bin/ubbmisc.cgi?action=getip&number=4&topic=000664.cgi&ReplyNum=000001&forum=ShowEQ+Linux+Development&TopicSubject=TCP+vs+UDP">Logged</A></font></P></td></tr><tr bgcolor="#1f1f1f">
	<TD width=18% valign=top>
	<FONT SIZE="2" face="Verdana, Arial"><B>Mr Guy</B></font><BR><FONT SIZE="1" face="Verdana, Arial">Zombie </FONT>
</td>
<TD>
<IMG SRC="http://www.ethernalquest.com/ubb/icons/icon1.gif" BORDER=0 ALIGN=ABSCENTER>
<FONT SIZE="2" FACE="Verdana, Arial">
<FONT SIZE="1" color="#32cd32" face="Verdana, Arial">posted 11-19-2001 03:37 PM &nbsp;&nbsp;&nbsp;
<A HREF="http://www.ethernalquest.com/cgi-bin/ubbmisc.cgi?action=getbio&UserName=Mr+Guy" target=_blank>
<IMG SRC="http://www.ethernalquest.com/ubb/profile.gif" BORDER=0 ALT="Click Here to See the Profile for Mr Guy"></A> &nbsp;&nbsp;<A HREF="http://www.ethernalquest.com/cgi-bin/Ultimate.cgi?action=email&ToWhom=Mr+Guy" target=_blank><IMG SRC="http://www.ethernalquest.com/ubb/email.gif" BORDER=0 ALT="Click Here to Email Mr Guy"></A>&nbsp;&nbsp; &nbsp;&nbsp;<A HREF="http://www.ethernalquest.com/cgi-bin/postings.cgi?action=editpost&forum=ShowEQ+Linux+Development&number=4&topic=000664.cgi&ReplyNum=000002&TopicSubject=TCP+vs+UDP"><IMG SRC="http://www.ethernalquest.com/ubb/edit.gif"  BORDER=0 ALT="Edit/Delete Message"></A> 
</FONT><HR>Darn, I was afraid of that.<P>In that case, can someone help me with this problem:<BR>&lt;code&gt;<BR>/* fetch them from pcap */<BR>  while (size = EQPacketGetPacket (buffer))<BR>  {<BR>    /* Get pointer to MAC layer header */<BR>    struct ether_header *ep;<BR>    ep = (struct ether_header *) buffer;<BR>    /* If its not an IP packet, discard the packet */<BR>    if (ntohs (ep-&gt;ether_type) != ETHERTYPE_IP)<BR>      continue;<P>    /* Now.. we know the rest is an IP udp packet concerning the<BR>     * host in question, because pcap takes care of that.<BR>     */<P>    /* Now we assume its an everquest packet */<BR>    if (showeq_params-&gt;recordpackets)<BR>    {<BR>      time_t now = time(NULL);<BR>      m_pVPacket-&gt;Record((const char *) buffer, size, now, PACKETVERSION);<BR>    }<P>    decodePacket ( size - sizeof (struct ether_header),<BR>                   (unsigned char *) buffer + sizeof (struct ether_header)<BR>                   );<BR>  }&lt;/code&gt;<P>ether_head looks like:<BR>&lt;code&gt;<BR>/* 10Mb/s ethernet header */<BR>struct ether_header<BR>{<BR>  u_int8_t  ether_dhost[ETH_ALEN];      /* destination eth addr */<BR>  u_int8_t  ether_shost[ETH_ALEN];      /* source ether addr    */<BR>  u_int16_t ether_type;                 /* packet type ID field */<BR>} __attribute__ ((__packed__));<BR>&lt;/code&gt;<P>The ether_head comes from net/ethernet.h.<P>Assuming you don't have net/ethernet.h available to you, how might you get this part to work?  <BR>&lt;code&gt;<BR>ep = (struct ether_header *) buffer;<BR>    if (ntohs (ep-&gt;ether_type) != ETHERTYPE_IP)<BR>&lt;/code&gt;<P>How crucial is this part anyway?<BR>From the looks of it, sure I'll pick up some random junk before logging to the world server, but does that matter horribly? <P>Related question, or I guess core question, how can I tell a UDP packet from an TCP packet?<p>[This message has been edited by Mr Guy (edited 11-19-2001).]</FONT><P align=right><FONT SIZE="1" color="#32cd32" face="Verdana, Arial">IP: <A HREF="http://www.ethernalquest.com/cgi-bin/ubbmisc.cgi?action=getip&number=4&topic=000664.cgi&ReplyNum=000002&forum=ShowEQ+Linux+Development&TopicSubject=TCP+vs+UDP">Logged</A></font></P></td></tr><tr bgcolor="#1f1f1f">
	<TD width=18% valign=top>
	<FONT SIZE="2" face="Verdana, Arial"><B>Froggy</B></font><BR><FONT SIZE="1" face="Verdana, Arial">Zombie </FONT>
</td>
<TD>
<IMG SRC="http://www.ethernalquest.com/ubb/icons/icon1.gif" BORDER=0 ALIGN=ABSCENTER>
<FONT SIZE="2" FACE="Verdana, Arial">
<FONT SIZE="1" color="#32cd32" face="Verdana, Arial">posted 11-19-2001 07:28 PM &nbsp;&nbsp;&nbsp;
<A HREF="http://www.ethernalquest.com/cgi-bin/ubbmisc.cgi?action=getbio&UserName=Froggy" target=_blank>
<IMG SRC="http://www.ethernalquest.com/ubb/profile.gif" BORDER=0 ALT="Click Here to See the Profile for Froggy"></A> &nbsp;&nbsp;<A HREF="http://www.ethernalquest.com/cgi-bin/Ultimate.cgi?action=email&ToWhom=Froggy" target=_blank><IMG SRC="http://www.ethernalquest.com/ubb/email.gif" BORDER=0 ALT="Click Here to Email Froggy"></A>&nbsp;&nbsp; &nbsp;&nbsp;<A HREF="http://www.ethernalquest.com/cgi-bin/postings.cgi?action=editpost&forum=ShowEQ+Linux+Development&number=4&topic=000664.cgi&ReplyNum=000003&TopicSubject=TCP+vs+UDP"><IMG SRC="http://www.ethernalquest.com/ubb/edit.gif"  BORDER=0 ALT="Edit/Delete Message"></A> 
</FONT><HR>ShowEQ's pcap filter only brings in UDP packets. Look through pcap.c for pcap_setfilter to change it. <P>Once you are filtering both TCP and UDP packets, you'll have to pull the IP header out of each packet to check the protocol type.</FONT><P align=right><FONT SIZE="1" color="#32cd32" face="Verdana, Arial">IP: <A HREF="http://www.ethernalquest.com/cgi-bin/ubbmisc.cgi?action=getip&number=4&topic=000664.cgi&ReplyNum=000003&forum=ShowEQ+Linux+Development&TopicSubject=TCP+vs+UDP">Logged</A></font></P></td></tr><tr bgcolor="#1f1f1f">
	<TD width=18% valign=top>
	<FONT SIZE="2" face="Verdana, Arial"><B>Mr Guy</B></font><BR><FONT SIZE="1" face="Verdana, Arial">Zombie </FONT>
</td>
<TD>
<IMG SRC="http://www.ethernalquest.com/ubb/icons/icon1.gif" BORDER=0 ALIGN=ABSCENTER>
<FONT SIZE="2" FACE="Verdana, Arial">
<FONT SIZE="1" color="#32cd32" face="Verdana, Arial">posted 11-19-2001 10:58 PM &nbsp;&nbsp;&nbsp;
<A HREF="http://www.ethernalquest.com/cgi-bin/ubbmisc.cgi?action=getbio&UserName=Mr+Guy" target=_blank>
<IMG SRC="http://www.ethernalquest.com/ubb/profile.gif" BORDER=0 ALT="Click Here to See the Profile for Mr Guy"></A> &nbsp;&nbsp;<A HREF="http://www.ethernalquest.com/cgi-bin/Ultimate.cgi?action=email&ToWhom=Mr+Guy" target=_blank><IMG SRC="http://www.ethernalquest.com/ubb/email.gif" BORDER=0 ALT="Click Here to Email Mr Guy"></A>&nbsp;&nbsp; &nbsp;&nbsp;<A HREF="http://www.ethernalquest.com/cgi-bin/postings.cgi?action=editpost&forum=ShowEQ+Linux+Development&number=4&topic=000664.cgi&ReplyNum=000004&TopicSubject=TCP+vs+UDP"><IMG SRC="http://www.ethernalquest.com/ubb/edit.gif"  BORDER=0 ALT="Edit/Delete Message"></A> 
</FONT><HR>Ok I'm confus-ed.  I'm setting the filter to <BR>"udp[2:2] = 9000 or (udp[0:2] &gt; 1024 and udp[2:2] &gt; 1024)"<P>I'm still seeing packets though that include things like the world server names.  I thought those were supposed to be TCP</FONT><P align=right><FONT SIZE="1" color="#32cd32" face="Verdana, Arial">IP: <A HREF="http://www.ethernalquest.com/cgi-bin/ubbmisc.cgi?action=getip&number=4&topic=000664.cgi&ReplyNum=000004&forum=ShowEQ+Linux+Development&TopicSubject=TCP+vs+UDP">Logged</A></font></P></td></tr></table><table border=0 width="95%"><TR><TD valign=top align=left><FONT SIZE="1" FACE="Verdana, Arial"><P>All times are ET (US)</FONT></td><td align=right valign=top><FONT SIZE="1" FACE="Verdana, Arial"><A HREF="http://www.ethernalquest.com/cgi-bin/ubbmisc.cgi?action=findthread&forum=Forum4&number=4&thisthread=000664&go=newer"><ACRONYM TITLE="Go to the next newest topic.">next newest topic</ACRONYM></A> | <A HREF="http://www.ethernalquest.com/cgi-bin/ubbmisc.cgi?action=findthread&forum=Forum4&number=4&thisthread=000664&go=older"><ACRONYM TITLE="Go to the next oldest topic.">next oldest topic</ACRONYM></A></font></td></tr>
<tr><td colspan=2><FONT SIZE="1" FACE="Verdana, Arial"><BR><CENTER><B>Administrative Options: <A HREF="http://www.ethernalquest.com/cgi-bin/postings.cgi?action=closethread&topic=000664.cgi&TopicSubject=TCP+vs+UDP&number=4&forum=ShowEQ+Linux+Development">Close Topic</A> | <A HREF="http://www.ethernalquest.com/cgi-bin/archive.cgi?action=transfer&topic=000664.cgi&TopicSubject=TCP+vs+UDP&number=4&forum=ShowEQ+Linux+Development">Archive/Move</A> | <A HREF="http://www.ethernalquest.com/cgi-bin/postings.cgi?action=deletepost&forum=ShowEQ+Linux+Development&number=4&topic=000664.cgi&TopicSubject=TCP+vs+UDP">Delete Topic</A></B></font></center></td></tr>
<TR><TD><A HREF="http://www.ethernalquest.com/cgi-bin/postings.cgi?action=newtopic&number=4&forum=ShowEQ+Linux+Development"><IMG SRC="http://www.ethernalquest.com/ubb/hq-post.jpg"  BORDER=0 ALT="Post New Topic"></A>&nbsp;&nbsp;<A HREF="http://www.ethernalquest.com/cgi-bin/postings.cgi?action=reply&forum=ShowEQ+Linux+Development&number=4&topic=000664.cgi&TopicSubject=TCP+vs+UDP"><IMG SRC="http://www.ethernalquest.com/ubb/hq-reply.jpg" BORDER=0 ALT="Post A Reply"></A></CENTER></TD>
<td align=right valign=top NOWRAP>
<FONT SIZE="2" FACE="Verdana, Arial">
<FORM ACTION="http://www.ethernalquest.com/cgi-bin/forumdisplay.cgi" METHOD="GET">
<INPUT TYPE="HIDDEN" NAME="action" VALUE="topics">
<B>Hop to: </B><SELECT NAME="number"><OPTION value="">Select a Forum or Archive
<OPTION value="">
<OPTION value="">List of Forums:
<OPTION value=""><OPTION value="1">HackersQuest Main Forum<OPTION value="2">EthernalQuest<OPTION value="3">ShowEQ<OPTION value="4" SELECTED>ShowEQ Linux Development<OPTION value="6">EthernalQuest Bugs<OPTION value="7">Emulator Scripting<OPTION value="8">Other Games<OPTION value="9">Anarchy Online<OPTION value="10">Hex Editing<OPTION value="11">Dark Age of Camelot<OPTION value="">
<OPTION value="">List of Archives:
<OPTION value=""></SELECT>
<INPUT TYPE="SUBMIT" NAME="SUBMIT" VALUE="Go">
</FORM></FONT></TD></tr></TABLE>
<br><B><FONT SIZE="2" FACE="Verdana, Arial">
<A HREF="mailto:ashran@ethernalquest.com">Contact Us</A> | <A HREF="http://hackersquest.gomp.ch" target=_top>HackersQuest</A> 
</B></FONT>
<p><FONT COLOR="#dedfdf" size="1" FACE="Verdana, Arial">
<P>

<a href="http://infopop.com"><IMG SRC="http://www.ethernalquest.com/ubb/powered_by2.gif" border=0></a><br>
Ultimate Bulletin Board 5.47<br><br>

</FONT></CENTER></font><center>
<IFRAME WIDTH=468 HEIGHT=60 NORESIZE SCROLLING=No FRAMEBORDER=0
MARGINHEIGHT=0 MARGINWIDTH=0 NAME="Werbung"
SRC="http://data.gomp.net/werbung.htm">
 <!-- Werbebanner von Krawall.de -->

 <SCRIPT LANGUAGE="JavaScript"> <!--
_version=10; //--> </script>
<SCRIPT LANGUAGE="JavaScript1.1"> <!--
_version=11;
if (navigator.userAgent.indexOf('Mozilla/3') != -1){
_version=10;} // --> </script>
<SCRIPT LANGUAGE="JavaScript"> <!--
var server = 'oas.krawall.de';
var sitepage = "www.gomp.ch/homepage";
var position ="Top!Top";
if (! (RN)) {
var RN = new String (Math.random());
var RNS = RN.substring (2, 11);
}
var oas='http://' + server + '/RealMedia/ads/';
var oaspage= sitepage + '/1' + RNS + '@' + position;
if (_version < 11) {
  document.write ('<A HREF="' + oas + 'click_nx.ads/'+ oaspage + '"
TARGET="_blank" ><IMG SRC="' + oas + 'adstream_nx.ads/' + oaspage + '"
BORDER="0"  WIDTH="468" HEIGHT="60"  ALT="Hier klicken!" ></a>');
} else {
  document.write ('<SCRIPT LANGUAGE="JavaScript1.1" SRC="' + oas +
'adstream_jx.ads/' + oaspage + '">');
  document.write ('\<\!-- --\>');
  document.write ('\<\/SCRIPT\>');
  document.write ('\<\!-- --\>');
}
// -->
</SCRIPT>

</IFRAME></enter></body></html>