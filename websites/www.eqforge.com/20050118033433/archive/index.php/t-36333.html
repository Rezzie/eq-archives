<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html dir="ltr" lang="en">
<head>
	<title>Civilization Fanatics' Forums - Cruising the units_32 file in VB</title>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
	<meta name="keywords" content="civilization,civ2,civ3,civ4,civilization iii,civilization ii,civilization iv,downloads,scenarios,modpacks,maps,sid meier,firaxis,strategy,tips,reference" />
	<meta name="description" content="Dedicated to the entire Sid Meier's Civilization series." />
	<link rel="stylesheet" href="http://forums.civfanatics.com/archive/archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="./">Civilization Fanatics' Forums</a> &gt; <a href="f-3.html">COLOSSEUM</a> &gt; <a href="f-73.html">Computer Talk</a> &gt; Cruising the units_32 file in VB</div>
<hr />
<div class="pda"><a href="?pda=1">PDA</a></div>
<p class="largefont">View Full Version : <a href="http://forums.civfanatics.com/showthread.php?t=36333">Cruising the units_32 file in VB</a></p>
<hr />

<div class="post"><div class="posttop"><div class="username">GIDustin</div><div class="date">Nov 11, 2002, 12:14 AM</div></div><div class="posttext">I am new to VB and need some advice.  How would i open units_32.pcx and dispaly the icon at Coords X,Y, where X and Y will be changing quite often?  I assume a sub would do it, but I need that particular icon to appear on the screen (Much like the units tab in the civ 3 editor).  Also, I will need to gather the icon number, and I know that units_32 files are variable height and width, so it might get difficult.<br />
<br />
Thanks in advance<br />
<br />
GIDustin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">King of Camelot</div><div class="date">Nov 11, 2002, 03:54 PM</div></div><div class="posttext">What I would use is bitblt.  You will need two picture boxes, one with the uits_32.pcx loaded into it, you will want to make the picture box hidden, and one that is 33 x 33 pixels for the unit icon.  Bitblt copies a section from x, y to *I think* another x, y.  I will try to dig up what I have about bitblt and post it later because I was just about to start a project using bitblt.  As for the icon # i am sure you can make some kind of mathematical formula using the fact that each unit box is 33 x 33 from line to line.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">GIDustin</div><div class="date">Nov 11, 2002, 07:38 PM</div></div><div class="posttext">Your information (if it works) would work.  (Obviously).  Now all i need is a way to determine the height and width of the file so as to find out how many rows/columns of icons there are.<br />
<br />
I am sure this one is easy for most of you, but I havent stepped foot outside of CGI/Perl until yesterday.  :D <br />
<br />
Thanks<br />
<br />
GIDustin</div></div><hr />


<div class="post"><div class="posttop"><div class="username">ainwood</div><div class="date">Nov 12, 2002, 08:02 AM</div></div><div class="posttext">A really easy one would be to use the _mousemove event of the picturebox to spit out the (X,Y) coordinates as you move over the picture. :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">funxus</div><div class="date">Nov 13, 2002, 08:02 AM</div></div><div class="posttext">You can also use the VB version of BitBlt, PaintPicture.<br />
From MSDN:<br />
object.PaintPicture picture, x1, y1, width1, height1, x2, y2, width2, height2, opcode<br />
<br />
object: New pic<br />
picture: The picturebox you want to cut picture from<br />
x1,y1: Coordinates to start new drawing on in object<br />
width1, height1: size of new drawing, (should be omitted, since it will resize the drawing)<br />
x2,y2: Where to start cut from old picture<br />
width2,height2: How much to cut from old picture<br />
opcode: Special commands( skip it)<br />
<br />
newpic.PaintPicture oldpic, 35, 40, , , 10, 15, 20, 33 <br />
<br />
This code will:<br />
-Draw a new picture at coordinate (35,40) in newpic, with the same size as the source<br />
-The  new picture is taken from oldpic, a square with the coordinates (10,15)-(10+20, 15+33)<br />
<br />
If you're new, it's easier to use the built-in functions in VB than using APIs. OTOH APIs are good to know:)</div></div><hr />

<div id="copyright">vBulletin v3.0.5, Copyright &copy;2000-2005, Jelsoft Enterprises Ltd.</div>
</div>
</body>
</html>